{% extends 'base.html.twig' %}

{% block title %}Dashboard for the Mediterranean  {% endblock %}

{% block stylesheets %}

{% endblock %}

{% block body %}
<!--<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="btn-group pull-right m-b-5">
                <button class="btn btn-icon waves-effect waves-light btn-primary m-b-5" data-toggle="modal" data-target="#pdf"><i class=" fa fa-file-pdf-o fa-2x"></i></button>

            </div>
        </div>
    </div>
</div>-->

<div class="row">
    <div class="col-lg-3 col-md-6">
        <div class="card-box widget-box-two widget-two-primary">
            <i class="mdi mdi-bookmark-check  widget-two-icon"></i>
            <div class="wigdet-two-content text-white">
                <p class="m-0 text-uppercase font-600 font-secondary text-overflow" title="Statistics">Total Species
                    in the Catalogue</p>
                <h2 class="text-white"><span data-plugin="counterup">{{ total }}</span>

                </h2>

            </div>
        </div>
    </div><!-- end col -->
    <div class="col-lg-3 col-md-6">
        <div class="card-box widget-box-two widget-two-info">
            <i class=" mdi mdi-database widget-two-icon"></i>
            <div class="wigdet-two-content text-white">
                <p class="m-0 text-uppercase font-600 font-secondary text-overflow" title="Statistics">Total Species
                    in MAMIAS</p>
                <h2 class="text-white"><span data-plugin="counterup">{{ Species_MAMIAS }}</span>

                </h2>

            </div>
        </div>
    </div><!-- end col -->

    <div class="col-lg-3 col-md-6">
        <div class="card-box widget-box-two widget-two-orange">
            <i class="mdi mdi-layers widget-two-icon"></i>
            <div class="wigdet-two-content text-white">
                <p class="m-0 text-uppercase font-600 font-secondary text-overflow" title="User This Month">
                    Total Established Species </p>
                <h2 class="text-white"><span data-plugin="counterup">{{ established }} </span>

                </h2>

            </div>
        </div>
    </div><!-- end col -->

    <div class="col-lg-3 col-md-6">
        <div class="card-box widget-box-two widget-two-danger">
            <i class="mdi mdi-clipboard-alert widget-two-icon"></i>
            <div class="wigdet-two-content text-white">
                <p class="m-0 text-uppercase font-600 font-secondary text-overflow" title="Statistics">
                    Total Invasive Species </p>
                <h2 class="text-white"><span data-plugin="counterup">{{ invasive }}</span>

                </h2>

            </div>
        </div>
    </div>
</div>

<div class="row">

    <div class="col-lg-5">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="barchart2"
                     style="min-width: 500px; max-width: 100%;height: 500px; margin: 0 auto; "></div>
            </div>
        </div>
    </div>

    <div class="col-lg-7">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="linechart"
                     style="min-width: 500px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
</div>
<div class="row">

    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="linechart1"
                     style="min-width: 500px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="barchart1"
                     style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>

</div>

<div class="row">
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="piechart4"
                     style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="piechart2"
                     style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>

</div>
<div class="row">
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="piechart1"
                     style="min-width: 50%; max-width: 100%;height: 500px; margin: 0 auto; "></div>
            </div>

        </div>
    </div>
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="piechart3"
                     style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6">
        <div class="property-card bg-white">
            <div class="property-content">
                <div id="barchart3"
                     style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
            </div>
        </div>

    </div>

    <div class="col-lg-6">

        <div class="property-card bg-white">
            <div class="property-content">
                <!-- <div id="column1"
                      style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>
             </div>-->

                <div id="container" style="min-width: 400px; max-width: 100%;height: 500px; margin: 0 auto;"></div>

            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="card-bbox">

            </div>

        </div>
    </div>


    {% endblock %}

    {% block javascripts %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.6/proj4.js"></script>
        <script src="{{ asset('assets/highcharts/highcharts.js') }}"></script>
        <script src="{{ asset('assets/highcharts/modules/data.js') }}"></script>
        <script src="{{ asset('assets/highcharts/highcharts-3d.js') }}"></script>
        <script src="{{ asset('assets/highcharts/modules/accessibility.js') }}"></script>
        <script src="{{ asset('assets/highcharts/regression.js') }}"></script>

        {% if is_granted('ROLE_REGSITREDUSER') %}
        <script src="{{ asset('assets/highcharts/modules/exporting.js') }}"></script>
        <script src="{{ asset('assets/highcharts/modules/offline-exporting.js') }}"></script>
        {% endif %}
        <script src="{{ asset('assets/highcharts/modules/no-data-to-display.js') }}"></script>
        <script src="{{ asset('assets/highcharts/modules/series-label.js') }}"></script>
        <script>
            {{ chart(piechart1) }}
            {{ chart(piechart2) }}
            {{ chart(barchart1) }}
            {{ chart(piechart3) }}
            {{ chart(piechart4) }}
            {{ chart(barchart2) }}
            {{ chart(linechart) }}
            {{ chart(barchart3) }}
            {{ chart(linechart1) }}


        </script>

        <script language="JavaScript">
            $(document).ready(function () {

                //var json_vectorcer = {{ json_vectorcer | raw }}
                //var json_vectorcer = [{"count":1,"vector_name":"Contaminant","certainty":"Low"},{"count":3,"vector_name":"Contaminant","certainty":"Medium"},{"count":1,"vector_name":"Corridor","certainty":null},{"count":2,"vector_name":"Corridor","certainty":"High"},{"count":12,"vector_name":"Corridor","certainty":"Low"},{"count":18,"vector_name":"Corridor","certainty":"Medium"},{"count":1,"vector_name":"Escape","certainty":"Low"},{"count":1,"vector_name":"Escape","certainty":null},{"count":2,"vector_name":"Escape","certainty":"Medium"},{"count":8,"vector_name":"Stowaway","certainty":null},{"count":26,"vector_name":"Stowaway","certainty":"High"},{"count":34,"vector_name":"Stowaway","certainty":"Low"},{"count":37,"vector_name":"Stowaway","certainty":"Medium"},{"count":2,"vector_name":"Unaided","certainty":"Medium"},{"count":1,"vector_name":"Unknown","certainty":null}]

                $(function () {

                    var data = {{ json_vectorcer | raw }}
                    var seriesData = [];
                    var xCategories = [];
                    var i, cat;
                    for (i = 0; i < data.length; i++) {
                        cat = data[i].vector_name;
                        if (xCategories.indexOf(cat) === -1) {
                            xCategories[xCategories.length] = cat;
                        }
                    }
                    for (i = 0; i < data.length; i++) {
                        if (seriesData) {
                            var currSeries = seriesData.filter(function (seriesObject) {
                                return seriesObject.name == data[i].certainty;
                            });
                            if (currSeries.length === 0) {
                                seriesData[seriesData.length] = currSeries = {name: data[i].certainty, data: []};
                            } else {
                                currSeries = currSeries[0];
                            }
                            var index = currSeries.data.length;
                            currSeries.data[index] = data[i].count;
                        } else {
                            seriesData[0] = {name: data[i].certainty, data: [data[i].count]}
                        }
                    }

                    var chart;
                    $(document).ready(function () {
                        chart = new Highcharts.Chart({
                            chart: {
                                renderTo: 'container',
                                type: 'column'
                            },
                            title: {
                                text: 'Number of reported NIS known or likely to be introduced by each of the main pathways',
                                style: {
                                    color: '#00AEEF',
                                    fontFamily: 'Roboto',
                                }


                            },
                            xAxis: {
                                categories: xCategories
                            },
                            yAxis: {
                                min: 0,
                                title: {
                                    text: 'Number of reported NIS'
                                },
                                stackLabels: {
                                    enabled: true,
                                    style: {
                                        fontWeight: 'bold',
                                        color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
                                    }
                                }
                            },
                            legend: {
                                //align: 'centre',
                                //verticalAlign: 'bottom',

                                //floating: true,
                                title: {text: 'Certainty'},
                                backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColorSolid) || 'white',
                                borderColor: '#CCC',
                                borderWidth: 1,
                                shadow: false
                            },
                            tooltip: {
                                formatter: function () {
                                    return '<b>' + this.x + '</b><br/>' +
                                        this.series.name + ': ' + this.y + '<br/>' +
                                        'Total: ' + this.point.stackTotal;
                                }
                            },
                            plotOptions: {
                                column: {
                                    stacking: 'normal'
                                }
                            },
                            series: seriesData
                        });
                    });

                });


            });
        </script>

    {% endblock %}
